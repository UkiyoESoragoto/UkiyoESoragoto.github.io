(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{505:function(t,a,s){"use strict";s.r(a);var e=s(4),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("这篇备忘是基于"),s("code",[t._v("cocos2d-x 3.10在mac上编译，针对iOS与Android开发")]),t._v("的场合记录的")]),t._v(" "),s("p",[t._v("首先"),s("br"),t._v("\ncocos2d-x在android上不支持std::fstream "),s("sub",[t._v("见鬼去吧")])]),t._v(" "),s("p",[t._v("cocos的基本实现方式是fopen"),s("br"),t._v("\n然而在andorid端，fopen无法直接加载打包在apk内的文件 "),s("sub",[t._v("精妙绝伦 微笑")])]),t._v(" "),s("p",[t._v("总之一番折腾，总结出如下关系：")]),t._v(" "),s("h4",{attrs:{id:"表1-读取打包于app内的文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#表1-读取打包于app内的文件"}},[t._v("#")]),t._v(" 表1: 读取打包于app内的文件")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("Plantform")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("iOS")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("Android")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("td::fstream")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("✔︎")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("✘")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("fopen")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("✘")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("cocos2d::FileUnit::getDataFromFile")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("✔")])])])]),t._v(" "),s("p",[t._v("当然所有包内的文件都是不可写的，所以写文件还要先通过"),s("code",[t._v("cocos2d::FileUtils::getWritablePath")]),t._v("获取"),s("code",[t._v("可写路径")])]),t._v(" "),s("p",[t._v("总之今天这里的要记录的cocos2d-x跨平台文件读取解决方法就是："),s("br"),t._v("\n如果需要特殊的读一个文件(比如逐行读取内容)，先使用"),s("code",[t._v("getDataFromFile")]),t._v("获取格式为"),s("code",[t._v("cocos2d::Data")]),t._v("的数据，然后再用"),s("code",[t._v("writeDataToFile")]),t._v("将数据写入指定的文件。")]),t._v(" "),s("h4",{attrs:{id:"示例代码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例代码"}},[t._v("#")]),t._v(" 示例代码")]),t._v(" "),s("div",{staticClass:"language-cpp line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-cpp"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("auto")]),t._v(" db_name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"db"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("auto")]),t._v(" db_write "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FileUtils")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getWritablePath")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" db_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("auto")]),t._v(" s "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FileUtils")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getDataFromFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("db_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FileUtils")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeDataToFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" db_write"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("p",[t._v("通过这样的操作以后，就可以在"),s("code",[t._v("可写路径")]),t._v("内找到想要操作的文件了。")]),t._v(" "),s("p",[t._v("后记：cocos的"),s("code",[t._v("isFileExist")]),t._v("，"),s("code",[t._v("fullPathForFilename")]),t._v("等方法好像并不能用于"),s("code",[t._v("可写路径")]),t._v("内的文件")]),t._v(" "),s("LicencesComponent")],1)}),[],!1,null,null,null);a.default=n.exports}}]);